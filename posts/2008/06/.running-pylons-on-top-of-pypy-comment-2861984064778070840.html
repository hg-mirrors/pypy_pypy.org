<html><body><p>It tests that SQLAlchemy isn't depending on class dictionaries containing only string keys.<br><br>Unfortunately, this makes the test then depend on the ability to have non-string keys in the class dictionary.  ;-)<br><br>The test is to ensure that SQLAlchemy will be able to map objects whose *classes* have AddOns defined.<br><br>By the way, as of PEP 3115, the locals() of a class can be an arbitrary object, so making compile-time assumptions about what *can't* be done with a class' locals() is probably not a good idea.<br><br>Also, as of every existing version of Python&gt;=2.2, a metaclass may add non-dictionary keys to the class dictionary during class.__new__.  So, it has never been a valid assumption that class __dict__ keys *must* be strings.  If PyPy is relying on that, it is already broken, IMO.</p></body></html>