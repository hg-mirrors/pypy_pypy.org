<html><body><p>Option 5, implement STM on the operating system. Linux already has COW for processes, imagine COW-MERGE for threads.<br><br>When you start transactional mode, all pages are marked read-only, thread-private and COW. When you commit, dirty pages are merged with the processes' page maps, unless conflicts arise (the process already has dirty pages).<br><br>A simple versioning system and version checks would take care of conflict detection.<br><br>I just wonder how difficult it would be designing applications that can run on this model (conflicts at page level vs object level). <br><br>Thread-private allocation arenas are entirely possible to avoid new objects from creating conflicts all the time, so it would be a matter of making read-only use of objects really read-only, something I've done incrementally in patches already. Reference counts have to be externalized (taken out of PyObject), for instance.<br></p></body></html>