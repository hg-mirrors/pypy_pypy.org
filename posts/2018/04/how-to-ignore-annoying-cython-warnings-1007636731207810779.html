<html><body><div>
</div>
<div>
<br class="Apple-interchange-newline">
If you install any Cython-based module in PyPy 6.0.0, it is very likely that you get a warning like this:</div>
<pre><code>&gt;&gt;&gt;&gt; import numpy
/data/extra/pypy/6.0.0/site-packages/numpy/random/__init__.py:99: UserWarning: __builtin__.type size changed, may indicate binary incompatibility. Expected 888, got 408
  from .mtrand import *
</code></pre>
<div>
The TL;DR version is: the warning is a false alarm, and you can hide it by doing:</div>
<pre><code>$ pypy -m pip install pypy-fix-cython-warning
</code></pre>
<div>
The package does not contain any module, only a <code>.pth</code> file which installs a warning filter at startup.</div>
<h2>
Technical details</h2>
<div>
This happens because whenever Cython compiles a pyx file, it generates C code which does a sanity check on the C size of <code>PyType_Type</code>. PyPy versions up to 5.10 are buggy and report the incorrect size, so Cython includes a workaround to compare it with the incorrect value, when on PyPy.</div>
<div>
PyPy 6 fixed the bug and now <code>PyType_Type</code> reports the correct size; however, Cython still tries to compare it with the old, buggy value, so it (wrongly) emits the warning.</div>
<div>
Cython 0.28.2 includes a fix for it, so that C files generated by it no longer emit the warning. However, most packages are distributed with pre-cythonized C files. For example, <code>numpy-1.14.2.zip</code> include C files which were generated by Cython 0.26.1: if you compile it you still get the warning, even if you locally installed a newer version of Cython.<br>
<span style="color: #24292e;"><br></span>
<span style="color: #24292e;">There is not much that we can do on the PyPy side, apart for waiting for all the Cython-based packages to do a new release which include C files generated by a newer Cython.  In the mean time, installing this module will silence the </span><span style="color: #24292e;">warning.</span></div>
<div>
<div style="color: #24292e; font-size: 16px;">
<br></div>
</div></body></html>